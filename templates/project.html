{% extends "base.html" %}

{% block content %}

<h1>{{ repo.name }}</h1>

<ul class="links">
    {% if repo.website %}<li><a href="{{ repo.website }}">Website</a></li>{% endif %}
    <li><a href="{{ repo.github }}">GitHub</a></li>
</ul>

<p class="lead">{{ repo.description }}</p>

<h2>Contributors</h2>

<ul class="contributors">
    {% for c in repo.contributors %}
        <li><a href="{{ c.link }}">{{ c.name }}</a></li>
    {% endfor %}
</ul>

{% if is_editor %}
    <form action="" method="POST">
        <div class="form-group">
            <label for="body">Project Summary</label>
            <input id="summary" type="hidden" name="summary" value="{{ repo.summary|default('') }}">
            <trix-editor input="summary" class="trix-content"></trix-editor>
            <small class="form-text text-muted">A quick summary of the project.</small>
        </div>

        <div class="text-right">
            <button type="submit" class="btn btn-success mt-2">Save</button>
        </div>
    </form>
{% else %}
    <div class="summary trix-content">{{ repo.summary|safe }}</div>
{% endif %}

{% if is_editor %}
    <h2>New Blog Post</h2>
    <form action="{{ url_for('create_blog_post', project_name=repo.name) }}" method="POST">
        <div class="form-group">
            <label for="name">Post Name</label>
            <input type="text" class="form-control" id="name" name="name" placeholder="e.g. We Rock! Here's Why">
            <small class="form-text text-muted">The title of your new blog post.</small>
        </div>

        <div class="form-group">
            <label for="body">Post Body</label>
            <input id="body" type="hidden" name="body">
            <trix-editor input="body" class="trix-content"></trix-editor>
            <small class="form-text text-muted">The content of your blog post</small>
        </div>

        <div class="text-right">
            <button type="submit" class="btn btn-success mt-2">Add Blog Post</button>
        </div>
    </form>
{% endif %}

<h2>Blog</h2>

<ul class="posts">
    {% for p in posts %}
        <li>
            <h3>{{ p.name }}</h3>
            <p class="created_on">{{ p.created_on }}</p>
            <div class="body trix-content">{{ p.body|safe }}</div>
            {% if is_editor %}
                <a href="{{ url_for('update_blog_post', project_name=repo.name, post_id=p.id) }}">
                    Update
                </a>
                <a href="{{ url_for('delete_blog_post', project_name=repo.name, id=p.id) }}" class="text-danger">
                    Delete
                </a>
            {% endif %}
        </li>
    {% else %}
        <li>No blog posts yet :(</li>
    {% endfor %}
</ul>

{% endblock %}
